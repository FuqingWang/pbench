<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-05-28 Tue 16:50 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Nick Dokos" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" href="../../stylesheets/normalize.css" type="text/css"/>
<link rel="stylesheet" href="../../stylesheets/stylesheet.css" type="text/css"/>
<link rel="stylesheet" href="../../stylesheets/github-light.css" type="text/css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org6e7bc86">Frequently asked questions</a>
<ul>
<li><a href="#org370ea9b">I want to group related results together - how do I do that? (Part 1)</a></li>
<li><a href="#org4d7f55b">I like to rename the directory that pbench produces before I send it to the server so I can group results together - that's a good idea, right?</a></li>
<li><a href="#org09020a5">I want to group related results together - how do I do that? (Part 2)</a></li>
<li><a href="#org4818635">Why is the <code>metadata.log</code> file important?</a></li>
</ul>
</li>
<li><a href="#orgedca930">Do's and don'ts</a>
<ul>
<li><a href="#org0e67da4">Do</a></li>
<li><a href="#org77d4a0c">Do not</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-org6e7bc86" class="outline-2">
<h2 id="org6e7bc86">Frequently asked questions</h2>
<div class="outline-text-2" id="text-org6e7bc86">
</div>
<div id="outline-container-org370ea9b" class="outline-3">
<h3 id="org370ea9b">I want to group related results together - how do I do that? (Part 1)</h3>
<div class="outline-text-3" id="text-org370ea9b">
<p>
Use <code>--config</code> when running a benchmark.
</p>

<p>
This allows you to group together related results by using similar
config strings (and conversely, use dissimilar strings to separate
unrelated results), within the universe of your own results.
</p>

<p>
All of the benchmark scripts that pbench provides, use a standardized
name for the results directory (and hence the tarball that is packaged
up and sent to the server). E.g. <code>pbench-fio</code> creates a directory (under
<code>/var/lib/pbench-agent</code>) with the name <code>fio__2019.01.29T19.24.29</code> with just
the name of the benchmark and a time stamp.
</p>

<p>
But all the benchmark scripts take a <code>--config</code> option that allows an
(almost) arbitrary string to be added to the name of the results
directory: e.g <code>pbench-fio --config=foo</code> will produce a results
directory named <code>fio_foo_2019.01.29T19.24.29</code>. The only character that
is not allowed is the forward slash <code>/</code> for obvious reasons, but you
probably want to avoid spaces, newlines, colons and characters that
have special meaning to the shell (asterisks, backslashes, question
marks, etc.) 
</p>
</div>
</div>

<div id="outline-container-org4d7f55b" class="outline-3">
<h3 id="org4d7f55b">I like to rename the directory that pbench produces before I send it to the server so I can group results together - that's a good idea, right?</h3>
<div class="outline-text-3" id="text-org4d7f55b">
<p>
No.
</p>

<p>
Well, it can be done, but please don't do that. During the run, pbench
gathers up information about the run that the indexer uses later on:
the name of the directory is one of those pieces of information, so if
you change it, it will either confuse the indexer or it will be
indexed differently than you expect, making it difficult to retrieve
those results.
</p>

<p>
From v0.55 on, <code>pbench-move/copy-results</code> tries to detect this situation
and will abort the move/copy, leaving the results as-is. If this happens
frequently, we'll have to add another question to the FAQ !-)
</p>
</div>
</div>

<div id="outline-container-org09020a5" class="outline-3">
<h3 id="org09020a5">I want to group related results together - how do I do that? (Part 2)</h3>
<div class="outline-text-3" id="text-org09020a5">
<p>
Use <code>--prefix</code> and <code>--user</code> when moving/copying results to the server.
</p>

<p>
After you've run your benchmark and you are ready to send the results
to the server, there are a couple of things you should know about
<code>pbench-move/copy-results</code>.
</p>

<p>
There are two useful options to <code>pbench-move-results</code>: <code>--prefix</code> and
<code>--user--</code>. The latter was introduced in v0.51, the former has existed
for some time now. Basic usage is
</p>
<div class="org-src-container">
<pre class="src src-shell">pbench-move-results --user=&lt;user&gt; --prefix=foo/bar
</pre>
</div>
<p>
Let's say there are three result directories in your controller's <code>/var/lib/pbench-agent</code> directory:
</p>

<ul class="org-ul">
<li><code>benchmark_config_2018-08-15T20:12:21/</code></li>
<li><code>benchmark_config_2018-08-16T18:02:34/</code></li>
<li><code>benchmark_config_2018-08-15T17:55:32/</code></li>
</ul>

<p>
Then the three tarballs that <code>pbench-move-results</code> moves to the server
are organized as follows:
</p>

<ul class="org-ul">
<li>controller view: under the controller name
~results/&lt;controller&gt;/foo/bar, you will find (symlinks to) the
directories created from unpacking the tarballs.</li>
<li>user view: under <code>users/&lt;user&gt;/&lt;controller&gt;/foo/bar</code>, you will find
the same entries.</li>
</ul>

<p>
The value of <code>prefix</code> is an arbitrary sequence of names separated by <code>/</code>.
Each component is mapped to a subdirectory of each hierarchy. The value
of <code>user</code> is also arbitrary, but the expectation is that users are going
to use something line an IRC nick or email address to identify themselves.
If you are calling <code>pbench-move-results</code> from a script, you might want to
set the value of the <code>user</code> option using an environment variable, instead
of passing it as an option:
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="font-weight: bold;">export</span> <span style="font-weight: bold; font-style: italic;">PBENCH_USER</span>=&lt;user&gt;
...
pbench-move-results --prefix=foo/bar
</pre>
</div>
<p>
is equivalent to
</p>
<div class="org-src-container">
<pre class="src src-shell">pbench-move-results --user=&lt;user&gt; --prefix=foo/bar
</pre>
</div>
<p>
The values of both of these options are indexed, so the dashboard will
have access to them as well.  Currently, the dashboard ignores both of
them, but we anticipate that they will soon be used as selection criteria
for the results that a user might be interested in.
</p>
</div>
</div>

<div id="outline-container-org4818635" class="outline-3">
<h3 id="org4818635">Why is the <code>metadata.log</code> file important?</h3>
<div class="outline-text-3" id="text-org4818635">
<p>
The metadata log file collects information about the run as the
benchmark script is running (name of the run, start and end times,
controller name, tool information, etc.)  The indexer will look for
the metadata log file in the top level directory of the tarball that
is sent to the server and will <b>NOT</b> process the tarball if the
metadata log file is missing or it does not contain the information
the indexer requires.
</p>

<p>
Right now, you can look at your results because we expand and store
the tarballs on the server, but this does <b>not</b> scale: we soon will
depend <b>solely</b> on the index for visualizing the results, so it
behooves us to make sure that the indexing works. In particular, if
you write your own benchmark scripts, please make sure that it
produces a metadata log file (see e.g. <code>pbench-user-bencmark</code>, the
simplest benchmark script, to see how to go about doing that).
</p>
</div>
</div>
</div>

<div id="outline-container-orgedca930" class="outline-2">
<h2 id="orgedca930">Do's and don'ts</h2>
<div class="outline-text-2" id="text-orgedca930">
</div>
<div id="outline-container-org0e67da4" class="outline-3">
<h3 id="org0e67da4">Do</h3>
<div class="outline-text-3" id="text-org0e67da4">
<ul class="org-ul">
<li>namespace your own results by using the <code>--config</code> option to the
benchmark script - see <a href="#org370ea9b">I want to group related results together -
how do I do that? (Part 1)</a></li>
<li>namespace your results (within the universe of <b>all</b> results) by
using the <code>--prefix</code> and <code>--user</code> options of <code>pbench-move-results</code> -
see: <a href="#org09020a5">I want to group related results together - how do I do that?
(Part 2)</a></li>
<li>make sure that the metadata log file exists and is complete (at
least with a start and end time for the run) - otherwise, the
indexer will not index the tarball.</li>
</ul>
</div>
</div>

<div id="outline-container-org77d4a0c" class="outline-3">
<h3 id="org77d4a0c">Do not</h3>
<div class="outline-text-3" id="text-org77d4a0c">
<ul class="org-ul">
<li>move multiple results into a subdirectory of <code>/var/lib/pbench-agent</code>
in an effort to namespace the results: <code>pbench-move-results</code> will
create a single tarball and it will unpack it seemingly
successfully, but your results will fail to index, because the
indexer cannot make heads or tails of the structure.</li>
<li>rename results directories before you use <code>pbench-move/copy-results</code></li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Nick Dokos</p>
<p class="date">Created: 2019-05-28 Tue 16:50</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
